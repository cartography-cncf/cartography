# Map principals that can read items from an S3Bucket. Specifically,
# create an (:AWSPrincipal)-[:CAN_READ]->(:S3Bucket) relationship
# for principals that have a policy attached with _any_ of the below
# permissions. Similar logic applies for the other entries in this file.

# S3 Read
- target_label: S3Bucket
  permissions:
  - S3:GetObject
  relationship_name: CAN_READ

# S3 Write
- target_label: S3Bucket
  permissions:
  - S3:PutObject
  relationship_name: CAN_WRITE

# ECR Write
- target_label: ECRRepository
  permissions:
  - ecr:PutImage
  relationship_name: CAN_WRITE

# ECR Read
- target_label: ECRRepository
  permissions:
  - ecr:BatchGetImage
  - ecr:GetDownloadUrlForLayer
  relationship_name: CAN_READ

# Redshift Admin
- target_label: RedshiftCluster
  permissions:
  - redshift:*
  - redshift:CreateClusterUser
  - redshift:GetClusterCredentials
  - redshift:JoinGroup
  relationship_name: CAN_ADMINISTER

# DynamoDB Read
- target_label: DynamoDBTable
  permissions:
  - dynamodb:BatchGetItem
  - dynamodb:GetItem
  - dynamodb:GetRecords
  - dynamodb:Query
  relationship_name: CAN_QUERY