{
    "name": "Analysis jobs for ModuleSyncMetaData nodes for AWS S3Bucket syncs",
    "statements": [{
        "__comment__": "Remove the old nodes",
        "query": "MATCH (n:ModuleSyncMetaData{id:'AWSAccount_' + {AWS_ID} +'_S3Bucket'}) WHERE n.lastupdated <> {UPDATE_TAG} WITH n LIMIT {LIMIT_SIZE} DETACH DELETE (n) return COUNT(*) as TotalCompleted",
        "iterative": false
    },{
        "__comment__": "Create the new nodes",
        "query": "MERGE (n:ModuleSyncMetaData{id:'AWSAccount_' + {AWS_ID} +'_S3Bucket'}) ON CREATE SET n:SyncMetadata, n.firstseen=timestamp() SET n.syncedtype='S3Bucket', n.grouptype='AWSAccount', n.groupid={AWS_ID}, n.lastupdated={UPDATE_TAG} return COUNT(*) as TotalCompleted",
        "iterative": false
    }]
}
