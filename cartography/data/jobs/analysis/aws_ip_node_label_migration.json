{
  "statements": [
  {
    "__comment__": "Drop legacy AWSAccount->RESOURCE edges to pre-migration shared IpRange nodes.",
    "query": "MATCH (:AWSAccount)-[r:RESOURCE]->(n:IpRange) WHERE NOT n:AWSIpRange DELETE r",
    "iterative": false
  },
  {
    "__comment__": "Drop legacy AWSAccount->RESOURCE edges to pre-migration shared IpRule nodes.",
    "query": "MATCH (:AWSAccount)-[r:RESOURCE]->(n:IpRule) WHERE NOT n:AWSIpRule DELETE r",
    "iterative": false
  },
  {
    "__comment__": "Drop legacy AWSAccount->RESOURCE edges to pre-migration shared IpPermissionInbound nodes.",
    "query": "MATCH (:AWSAccount)-[r:RESOURCE]->(n:IpPermissionInbound) WHERE NOT n:AWSIpPermissionInbound DELETE r",
    "iterative": false
  },
  {
    "__comment__": "Delete legacy IpRange nodes that were never re-created with provider-scoped labels.",
    "query": "MATCH (n:IpRange) WHERE NOT (n:AWSIpRange OR n:GCPIpRange) DETACH DELETE n",
    "iterative": false
  },
  {
    "__comment__": "Delete legacy IpRule nodes that were never re-created with provider-scoped labels.",
    "query": "MATCH (n:IpRule) WHERE NOT (n:AWSIpRule OR n:GCPIpRule) DETACH DELETE n",
    "iterative": false
  },
  {
    "__comment__": "Delete legacy IpPermissionInbound nodes that were never re-created with provider-scoped labels.",
    "query": "MATCH (n:IpPermissionInbound) WHERE NOT (n:AWSIpPermissionInbound OR n:GCPIpRule) DETACH DELETE n",
    "iterative": false
  }
  ],
  "name": "AWS IP node label migration"
}
