{
  "statements": [
    {
      "query": "MATCH (t:GCPBigQueryTable) WHERE t.lastupdated <> $UPDATE_TAG WITH t LIMIT $LIMIT_SIZE DETACH DELETE t",
      "iterative": true,
      "iterationsize": 100,
      "__comment__": "Remove GCP BigQuery tables that are out of date."
    },
    {
      "query": "MATCH (d:GCPBigQueryDataset) WHERE d.lastupdated <> $UPDATE_TAG WITH d LIMIT $LIMIT_SIZE DETACH DELETE d",
      "iterative": true,
      "iterationsize": 100,
      "__comment__": "Remove GCP BigQuery datasets that are out of date."
    },
    {
      "query": "MATCH (:GCPProject)-[r:RESOURCE]->(:GCPBigQueryDataset) WHERE r.lastupdated <> $UPDATE_TAG WITH r LIMIT $LIMIT_SIZE DELETE r",
      "iterative": true,
      "iterationsize": 100,
      "__comment__": "Remove GCP Project-to-BigQuery Dataset relationships that are out of date."
    },
    {
      "query": "MATCH (:GCPBigQueryDataset)-[r:CONTAINS]->(:GCPBigQueryTable) WHERE r.lastupdated <> $UPDATE_TAG WITH r LIMIT $LIMIT_SIZE DELETE r",
      "iterative": true,
      "iterationsize": 100,
      "__comment__": "Remove GCP BigQuery Dataset-to-Table relationships that are out of date."
    }
  ],
  "name": "cleanup GCP BigQuery"
}
