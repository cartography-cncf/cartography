from cartography.rules.data.frameworks.mitre_attack.requirements.t1190_exploit_public_facing_application.compute_instance_exposed import (
    compute_instance_exposed,
)
from cartography.rules.data.frameworks.mitre_attack.requirements.t1190_exploit_public_facing_application.database_instance_exposed import (
    database_instance_exposed,
)
from cartography.rules.data.frameworks.mitre_attack.requirements.t1190_exploit_public_facing_application.object_storage_public import (
    object_storage_public,
)
from cartography.rules.spec.model import Requirement

t1190 = Requirement(
    id="t1190",
    name="Exploit Public-Facing Application",
    description="Adversaries may attempt to take advantage of a weakness in an Internet-facing computer or program using software, data, or commands in order to cause unintended or unanticipated behavior.",
    target_assets="Compute and storage resources that are accessible from the public internet",
    findings=(
        object_storage_public,
        compute_instance_exposed,
        database_instance_exposed,
    ),
    requirement_url="https://attack.mitre.org/techniques/T1190/",
    # TODO: should we have a per-framework class represent the attributes?
    attributes={
        "tactic": "initial_access",
        "technique_id": "T1190",
        "services": ["ec2", "s3", "rds", "azure_storage"],
        "providers": ["AWS", "AZURE"],
    },
)
