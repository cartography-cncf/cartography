"""Ontology schema for Vulnerability nodes.

Provides a unified schema for vulnerability data across different scanners
(Trivy, Semgrep, AWS Inspector, etc.).
"""

from dataclasses import dataclass

from cartography.models.core.common import PropertyRef
from cartography.models.core.nodes import CartographyNodeProperties
from cartography.models.core.nodes import CartographyNodeSchema
from cartography.models.core.nodes import ExtraNodeLabels


@dataclass(frozen=True)
class VulnerabilityNodeProperties(CartographyNodeProperties):
    """Properties for Vulnerability ontology nodes."""

    id: PropertyRef = PropertyRef("cve_id")
    lastupdated: PropertyRef = PropertyRef("lastupdated", set_in_kwargs=True)
    cve_id: PropertyRef = PropertyRef("cve_id", extra_index=True)
    severity: PropertyRef = PropertyRef("severity", extra_index=True)
    cvss_score: PropertyRef = PropertyRef("cvss_score")
    cvss_vector: PropertyRef = PropertyRef("cvss_vector")
    description: PropertyRef = PropertyRef("description")
    published_date: PropertyRef = PropertyRef("published_date")
    last_modified_date: PropertyRef = PropertyRef("last_modified_date")


@dataclass(frozen=True)
class VulnerabilitySchema(CartographyNodeSchema):
    """Ontology schema for Vulnerability nodes.

    Normalizes vulnerability data from different sources into a common format.
    Enables scanner-agnostic queries across Trivy, Semgrep, AWS Inspector, etc.
    """

    label: str = "Vulnerability"
    extra_node_labels: ExtraNodeLabels = ExtraNodeLabels(["Ontology"])
    properties: VulnerabilityNodeProperties = VulnerabilityNodeProperties()
    scoped_cleanup: bool = False
